<app-navbar></app-navbar>

<div class="container mt-4">
  <h4 class="title mb-3">Barrios</h4>

  <!-- Botón alineado a la derecha -->
 <div class="row mb-3" *ngIf="rolUser === 'Admin'">
  <div class="col-md-4 offset-md-8 d-flex justify-content-center">
    <button
      class="btn btn-primary"
      data-bs-toggle="modal"
      data-bs-target="#addBarrioModal"
    >
      <i class="bi bi-plus"></i> Añadir barrio
    </button>
  </div>
</div>

<!-- Modal Añadir Barrio-->
<div class="modal fade" id="addBarrioModal" tabindex="-1" aria-labelledby="addBarrioModalLabel" aria-hidden="true">
 <div class="modal-dialog">
    <div class="modal-content">

        <div class="modal-header">
            <h5 class="modal-title" id="addBarrioModalLabel">Añadir nuevo barrio</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Cerrar"></button>
        </div>

        <div class="modal-body">
            <form>

                <div class="mb-3">
                    <label for="nombre" class="form-label">Nombre</label>
                    <input type="text" class="form-control" id="nombre" [(ngModel)]="newBarrio.nombre" name="nombre">
                </div>

                <div class="mb-3">
                    <label for="descripcion" class="form-label">Descripción</label>
                    <input type="text" class="form-control" id="descripcion" [(ngModel)]="newBarrio.descripcion" name="descripcion">
                </div>

                <div class="mb-3">
                    <label for="latitud" class="form-label">Latitud</label>
                    <input type="number" class="form-control" id="latitud" [(ngModel)]="newBarrio.centroGeografico.latitud" name="latitud">
                </div>

                <div class="mb-3">
                    <label for="longitud" class="form-label">Longitud</label>
                    <input type="number" class="form-control" id="longitud" [(ngModel)]="newBarrio.centroGeografico.longitud" name="longitud">
                </div>
            </form>
        </div>

        <div class="modal-footer">
            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal" (click)="cancelar()">Cancelar</button>
            <button type="button" class="btn btn-primary" (click)="addBarrio()">Añadir</button> 

        </div>

    </div>

 </div>
</div>

<!-- Modal Editar Barrio -->
<div class="modal fade" id="editBarrioModal" tabindex="-1" aria-labelledby="editBarrioModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">

      <div class="modal-header">
        <h5 class="modal-title" id="editBarrioModalLabel">Editar barrio</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Cerrar"></button>
      </div>

      <div class="modal-body" *ngIf="selectedBarrio">
        <form>
          <div class="mb-3">
            <label for="editNombre" class="form-label">Nombre</label>
            <input
              type="text"
              class="form-control"
              id="editNombre"
              [(ngModel)]="selectedBarrio.nombre"
              name="editNombre"
            />
          </div>

          <div class="mb-3">
            <label for="editDescripcion" class="form-label">Descripción</label>
            <input
              type="text"
              class="form-control"
              id="editDescripcion"
              [(ngModel)]="selectedBarrio.descripcion"
              name="editDescripcion"
            />
          </div>

          <div class="mb-3">
            <label for="editLatitud" class="form-label">Latitud</label>
            <input
              type="number"
              class="form-control"
              id="editLatitud"
              [(ngModel)]="selectedBarrio.centroGeografico.latitud"
              name="editLatitud"
            />
          </div>

          <div class="mb-3">
            <label for="editLongitud" class="form-label">Longitud</label>
            <input
              type="number"
              class="form-control"
              id="editLongitud"
              [(ngModel)]="selectedBarrio.centroGeografico.longitud"
              name="editLongitud"
            />
          </div>
        </form>
      </div>

      <div class="modal-footer">
        <button
          type="button"
          class="btn btn-secondary"
          data-bs-dismiss="modal"
        >
          Cancelar
        </button>
        <button
          type="button"
          class="btn btn-primary"
          (click)="guardarCambiosBarrio()"
        >
          Guardar cambios
        </button>
      </div>

    </div>
  </div>
</div>

  <!-- Tabla -->
  <div class="row">
    <div class="col-12">
      <table class="table table-striped table-bordered table-hover table-sm">
        <tbody>
          <tr *ngFor="let barrio of barrios">
            <td class="align-middle text-center fw-semibold">
              {{ barrio.nombre }}
            </td>
            <td class="align-middle text-center fw-semibold">
              {{ barrio.descripcion }}
            </td>
            <td class="align-middle text-center fw-semibold">
              {{ barrio.centroGeografico.latitud }},
              {{ barrio.centroGeografico.longitud }}
            </td>

            <td *ngIf="rolUser === 'Admin'">
                <div class="d-flex justify-content-center gap-2">
                    <button class="btn btn-outline-primary" title="Editar" (click)="editBarrio(barrio)">
                    <i class="bi bi-pencil"></i>
                    </button>

                    <button class="btn btn-outline-danger" title="Eliminar" (click)="confirmDelete(barrio.id)">
                    <i class="bi bi-trash"></i>
                    </button>
                </div>
            </td>

          </tr>
        </tbody>
      </table>
    </div>
  </div>
</div>
